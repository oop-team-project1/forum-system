<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html lang="en-us" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>TastyTale</title>

    <!-- mobile responsive meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="This is meta description">
    <meta name="author" content="Themefisher">
    <meta name="generator" content="Hugo 0.74.3"/>

    <!-- plugins -->

    <link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="/plugins/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="/plugins/slick/slick.css">

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="/css/styles.css" media="screen">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--Favicon-->
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="icon" href="/images/favicon.png" type="image/x-icon">

    <meta property="og:title" content="Reader | Hugo Personal Blog Template"/>
    <meta property="og:description" content="This is meta description"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content=""/>
    <meta property="og:updated_time" content="2020-03-15T15:40:24+06:00"/>
</head>
<body>
<!-- navigation -->
<header class="navigation fixed-top">
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-white">
            <a class="navbar-brand order-1" href="index.html">
                <img class="img-fluid" width="80px" src="/images/logo-removebg-preview.png"
                     alt="Tasty tale logo">
            </a>
            <div class="collapse navbar-collapse text-center order-lg-2 order-3" id="navigation">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/}" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/users}" href="#">Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:unless="${isAuthenticated}" th:href="@{/auth/login}" href="#">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:unless="${isAuthenticated}" th:href="@{/auth/register}"
                           href="#">Register</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:if="${isAuthenticated}" th:href="@{/auth/logout}" href="#">Log
                            out</a>
                    </li>

                </ul>
            </div>

        </nav>
    </div>
</header>
<!-- /navigation -->
<div class="py-4"></div>
<section class="section">
    <div class="container">
        <div class="row">
            <div class=" col-lg-8 mb-5 mb-lg-0">
                <article>

                    <h1 th:text="${post.title}" class="h2"></h1>
                    <ul class="card-meta my-3 list-inline">
                        <!--                        <li class="list-inline-item">-->
                        <!--                            <i class="ti-timer"></i>3 Min To Read-->
                        <!--                        </li>-->
                        <li class="list-inline-item" style="font-size: 14px;">
                            <i th:text="${#temporals.format(post.date_of_creation, 'dd/MM/yyyy')}"
                               class="ti-calendar"></i>
                        </li>
                    </ul>
                    <div class="content">
                        <hr>
                        <p style="font-weight: 500" th:text="${post.content}"></p>

                    </div>
                </article>
                <hr>
                <div>
                    <form th:if="${isAuthenticated && !currentUser.isBlocked()}"
                          th:action="@{'/posts/' + ${post.id} + '/likes'}" method="post" style="display: inline-block;">
                        <input type="hidden" name="postId" th:value="${post.id}"/>
                        <button class="btn btn-outline-block" type="submit">
                            <i class="fa fa-heart"></i>
                            <span th:text="${post.likes}"></span>
                        </button>
                    </form>

                    <form th:unless="${isAuthenticated}" th:action="@{'/auth/login'}" style="display: inline-block;">
                        <input type="hidden" name="postId" th:value="${post.id}"/>
                        <button class="btn btn-outline-block" type="submit">
                            <i class="fa fa-heart"></i>
                            <span th:text="${post.likes}"></span>
                        </button>
                    </form>


                    <a th:if="${isAuthenticated && !currentUser.isBlocked()}" class="btn btn-outline-primary"
                       th:href="@{'/posts/' + ${post.id} + '/comments'}">
                        Comment
                    </a>
                    <a th:unless="${isAuthenticated}" class="btn btn-outline-primary" th:href="@{'/auth/login'}">
                        Comment
                    </a>

                </div>
                <div class="mt-5">
                    <div class="mb-5 border-top mt-4 pt-5">
                        <h3 class="mb-4">Comments</h3>
                        <div class="media d-block d-sm-flex mb-4 pb-4">

                            <div class="media-body">
                                <ul>
                                    <li th:each="comment : ${post.comments}" style="margin-bottom: 50px;">
                                        <h5 th:text="${comment.createdBy.firstName + ' ' + comment.createdBy.lastName}"></h5>
                                        <p th:text="${comment.commentContent}"></p>
                                        <p th:text="${#temporals.format(comment.date_of_creation, 'dd/MM/yyyy')}"></p>
                                        <a class="btn btn-outline-primary"
                                           th:if="${isAuthenticated && !currentUser.isBlocked()}"
                                           th:href="@{'/posts/' + ${post.id} + '/comments/' + ${comment.id} + '/replies'}"
                                        >Reply
                                        </a>
                                        <a class="btn btn-outline-primary"
                                           th:if="${isAuthenticated && (currentUser.isAdmin() || comment.createdBy.equals(currentUser))}"
                                           th:href="@{'/posts/' + ${post.id} + '/comments/' + ${comment.id} + '/update'}"
                                           style="margin-left: 20px;">Edit comment
                                        </a>
                                        <ul th:if="${comment.replies}">
                                            <div class="replies">

                                                <li th:each="reply : ${comment.replies}"
                                                    style="margin-bottom: 50px; margin-top: 50px;">
                                                    <h5 th:text="${reply.createdBy.firstName + ' ' + reply.createdBy.lastName}"></h5>
                                                    <img class="mr-3" src="/images/post/arrow.png" alt="">
                                                    <p th:text="${reply.commentContent}"
                                                       style="padding-left: 170px;"></p>
                                                    <p th:text="${#temporals.format(reply.date_of_creation, 'dd/MM/yyyy')}"
                                                       style="padding-left: 170px;"></p>

                                                    <a th:if="${isAuthenticated && !currentUser.isBlocked()}"
                                                       class="btn btn-outline-primary"
                                                       th:href="@{'/posts/' + ${post.id} + '/comments/' + ${comment.id} + '/replies'}"
                                                       style="margin-left: 160px;">Reply</a>
                                                    <a class="text-primary font-weight-600"
                                                       th:if="${isAuthenticated && (currentUser.isAdmin() || comment.createdBy.equals(currentUser))}"
                                                       th:href="@{'/posts/' + ${post.id} + '/comments/' + ${comment.id} + '/update'}"
                                                       style="padding-left: 250px;">Edit comment
                                                    </a>
                                                </li>
                                            </div>
                                        </ul>

                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!--                        <div class="media d-block d-sm-flex">-->
                        <!--                            <div class="d-inline-block mr-2 mb-3 mb-md-0" href="#">-->
                        <!--                                <img class="mr-3" src="/images/post/arrow.png" alt="">-->
                        <!--                                <a href="#!"><img src="/images/post/user-02.jpg" class="mr-3 rounded-circle" alt=""></a>-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                    </div>
                </div>
            </div>
            <aside class="col-lg-4 @@sidebar">
                <!-- about me -->
                <div class="widget widget-about">
                    <h2 class="widget-title" style="margin-top: 20px;"
                        th:text="${post.createdBy.firstName + ' ' + post.createdBy.lastName}">First name Last name</h2>
                    <div>
                        <a class="btn btn-outline-primary"
                           th:if="${ isAuthenticated && (currentUser.isAdmin() || currentUser.postsByUser.contains(post))}"
                           th:href="@{'/posts/' + ${post.id} + '/update'}">
                            Edit post
                        </a>
                        <a class="btn btn-outline-block"
                           th:if="${isAuthenticated && (currentUser.isAdmin() || currentUser.postsByUser.contains(post))}"
                           th:href="@{'/posts/' + ${post.id} + '/delete'}">
                            Delete post
                        </a>
                    </div>
                </div>

            </aside>
        </div>
    </div>
</section>
<footer class="footer">
    <svg class="footer-border" height="214" viewBox="0 0 2204 214" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2203 213C2136.58 157.994 1942.77 -33.1996 1633.1 53.0486C1414.13 114.038 1200.92 188.208 967.765 118.127C820.12 73.7483 263.977 -143.754 0.999958 158.899"
              stroke-width="2"/>
    </svg>


    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-2 text-center mb-4">
                <div class="col-md-2 text-center mb-4">
                    <img class="img-fluid" width="80px" src="/images/logo-removebg-preview.png"
                         alt="Tasty tale logo">
                </div>
            </div>

            <div class="col-12">
                <div class="border-bottom border-default"></div>
            </div>
        </div>
    </div>
</footer>


<!-- JS Plugins -->
<script src="/plugins/jQuery/jquery.min.js"></script>

<script src="/plugins/bootstrap/bootstrap.min.js"></script>

<script src="/plugins/slick/slick.min.js"></script>

<script src="/plugins/instafeed/instafeed.min.js"></script>


<!-- Main Script -->
<script src="/js/script.js"></script>
<script src="/js/comment.js"></script>
</body>
</html>